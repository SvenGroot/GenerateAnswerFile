{
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "GenerateAnswerFile JSON options.",
  "type": "object",
  "description": "Provides options for generating an unattended Windows installation answer file using GenerateAnswerFile.",
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "title": "Schema",
      "description": "Pointer to the schema against which this document should be validated."
    },
    "InstallOptions": {
      "description": "Options for the installation method. This should be an object with a '$type' property, or null to generate an answer file intended for a preinstalled image. Other available options depend on the value of '$type'.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "properties": {
            "$type": {
              "enum": [
                "CleanEfi",
                "CleanBios",
                "ExistingPartition",
                "Manual"
              ],
              "type": "string",
              "description": "The installation method to use."
            }
          },
          "required": [
            "$type"
          ],
          "allOf": [
            {
              "if": {
                "properties": {
                  "$type": {
                    "const": "CleanEfi"
                  }
                }
              },
              "then": {
                "$ref": "#/definitions/CleanEfiOptions"
              }
            },
            {
              "if": {
                "properties": {
                  "$type": {
                    "const": "CleanBios"
                  }
                }
              },
              "then": {
                "$ref": "#/definitions/CleanBiosOptions"
              }
            },
            {
              "if": {
                "properties": {
                  "$type": {
                    "const": "ExistingPartition"
                  }
                }
              },
              "then": {
                "$ref": "#/definitions/ExistingPartitionOptions"
              }
            },
            {
              "if": {
                "properties": {
                  "$type": {
                    "const": "Manual"
                  }
                }
              },
              "then": {
                "$ref": "#/definitions/ManualInstallOptions"
              }
            }
          ]    
        }
      ]
    },
    "JoinDomain": {
      "description": "Options for joining a domain, or null to not join a domain.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/DomainOptions"
        }
      ]
    },
    "ComputerName": {
      "type": [
        "null",
        "string"
      ],
      "description": "The computer name of the system, or null to let Windows generate one."
    },
    "EnableDefender": {
      "type": "boolean",
      "description": "Indicates whether Windows Defender is enabled after installation. The default value is true."
    },
    "EnableCloud": {
      "type": "boolean",
      "description": "Indicates whether cloud consumer features are enabled after installation. The default value is true. This may have no effect depending on the Windows version and edition being installed."
    },
    "EnableRemoteDesktop": {
      "type": "boolean",
      "description": "Indicates whether remote desktop accepts incoming connections after installation. The default value is false."
    },
    "EnableServerManager": {
      "type": "boolean",
      "description": "Indicates whether server manager will be launched on logon on Windows Server. The default value is true. This has no effect on non-Server editions of Windows."
    },
    "LocalAccounts": {
      "type": [ 
        "null",
        "array" 
      ],
      "description": "A list of local administrator accounts to create.",
      "items": {
        "$ref": "#/definitions/LocalCredential"
      }
    },
    "AutoLogon": {
      "description": "Options for logging on automatically, or null to not log on automatically.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/AutoLogonOptions"
        }
      ]
    },
    "CmdKeyAccount": {
      "description": "The credentials of an account that will be used to access all network locations, or null to not register any credentials for this.",
      "oneOf": [
        {
          "type": "null"
        },
        {
          "$ref": "#/definitions/DomainCredential"
        }
      ]
    },
    "DisplayResolution": {
      "description": "The display resolution, or null to let Windows determine the default resolution.",
      "type": [
        "null",
        "string"
      ],
      "pattern": "^\\d+,\\d+$"
    },
    "Language": {
      "type": "string",
      "description": "The language used for the UI and culture settings. The default is 'en-US'."
    },
    "ProductKey": {
      "type": [
        "null",
        "string"
      ],
      "description": "The product key used to determine the edition to install, and to activate Windows. This can be null when using a preinstalled image, or when installing an edition that does not require a product key such as a volume licensed edition."
    },
    "ProcessorArchitecture": {
      "type": "string",
      "description": "The processor architecture of the Windows version being installed. Valid values include 'amd64', 'x86', and 'arm64'. The default is 'amd64'."
    },
    "TimeZone": {
      "type": "string",
      "description": "The system time zone. Use 'tzutil /l' in a command prompt to list available time zones. The default is 'Pacific Standard Time'."
    },
    "FirstLogonCommands": {
      "type": [ 
        "null",
        "array" 
      ],
      "description": "A list of commands to run during first log-on.",
      "items": {
        "type": "string"
      }
    },
    "SetupScripts": {
      "type": [ 
        "null",
        "array" 
      ],
      "description": "A list of PowerShell scripts to run during first log-on. These are executed on first logon after the commands in FirstLogonCommands.",
      "items": {
        "type": "string"
      }
    }
  },
  "definitions": {
    "InstallOptionsBase": {
      "type": "object",
      "description": "Base type for types that provide options for a specific installation method.",
      "x-abstract": true,
      "properties": {
        "OptionalFeatures": {
          "description": "Optional features to install, or null to not install any.",
          "oneOf": [
            {
              "type": "null"
            },
            {
              "$ref": "#/definitions/OptionalFeatures"
            }
          ]
        }
      }
    },
    "TargetedInstallOptionsBase": {
      "allOf": [
        {
          "$ref": "#/definitions/InstallOptionsBase"
        },
        {
          "type": "object",
          "description": "Base type for all install options that target a specific disk and partition.",
          "x-abstract": true,
          "properties": {
            "DiskId": {
              "type": "integer",
              "description": "The zero-based index of the disk to which Windows will be installed.",
              "format": "int32",
              "minimum": 0
            },
            "ImageIndex": {
              "type": "integer",
              "description": "The index of the image in the WIM file to install. Use this for Windows editions not installed using a product key, such as those that use volume licensing. Use the PowerShell 'Get-WindowsImage' command to list all images in a .wim or .esd file.",
              "format": "int32",
              "minimum": 0
            }
          }
        }
      ]
    },
    "CleanOptionsBase": {
      "allOf": [
        {
          "$ref": "#/definitions/TargetedInstallOptionsBase"
        },
        {
          "type": "object",
          "description": "Base type for all install options that perform a clean installation on a specific disk.",
          "x-abstract": true,
          "properties": {
            "Partitions": {
              "type": [ 
                "null",
                "array" 
              ],
              "description": "A list of partitions to create, or null to use the default partition layout for the installation type.",
              "items": {
                "$ref": "#/definitions/Partition"
              }
            },
            "TargetPartitionId": {
              "type": [
                "integer",
                "null"
              ],
              "description": "The one-based index of the partition to install to, or null to install to the first regular data partition.",
              "format": "int32",
              "minimum": 1
            }
          }
        }
      ]
    },
    "CleanEfiOptions": {
      "allOf": [
        {
          "$ref": "#/definitions/CleanOptionsBase"
        },
        {
          "type": "object",
          "description": "Provides options for a clean installation on UEFI-based systems.",
          "properties": {
            "$type": {
              "type": "string",
              "description": "The installation method to use.",
              "const": "CleanEfi"
            }
          }
        }
      ]
    },
    "CleanBiosOptions": {
      "allOf": [
        {
          "$ref": "#/definitions/CleanOptionsBase"
        },
        {
          "type": "object",
          "description": "Provides options for a clean installation on BIOS-based systems.",
          "properties": {
            "$type": {
              "type": "string",
              "description": "The installation method to use.",
              "const": "CleanBios"
            }
          }
        }
      ]
    },
    "ExistingPartitionOptions": {
      "allOf": [
        {
          "$ref": "#/definitions/TargetedInstallOptionsBase"
        },
        {
          "type": "object",
          "description": "Provides options for installing to an existing partition.",
          "required": [
            "TargetPartitionId"
          ],
          "properties": {
            "$type": {
              "type": "string",
              "description": "The installation method to use.",
              "const": "ExistingPartition"
            },
            "TargetPartitionId": {
              "type": "integer",
              "description": "Gets or sets the ID of the partition to install to.",
              "format": "int32",
              "minimum": 1
            }
          }
        }
      ]
    },
    "ManualInstallOptions": {
      "allOf": [
        {
          "$ref": "#/definitions/InstallOptionsBase"
        },
        {
          "type": "object",
          "description": "Provides options for an installation where the disk and partition to install to must be manually selected by the user.",
          "properties": {
            "$type": {
              "type": "string",
              "description": "The installation method to use.",
              "const": "Manual"
            }
          }
        }
      ]
    },
    "OptionalFeatures": {
      "type": "object",
      "description": "Provides options for installing optional features.",
      "required": [
        "WindowsVersion"
      ],
      "additionalProperties": false,
      "properties": {
        "WindowsVersion": {
          "description": "The Windows version being installed. If this value does not match the actual version of Windows being installed, installation will fail.",
          "type": "string",
          "pattern": "^\\d+\\.\\d+.\\d+.\\d+$"
        },
        "Features": {
          "type": "array",
          "description": "A list of optional features to install.",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "Partition": {
      "type": "object",
      "description": "Specifies a partition to be created when using the CleanBiosOptions or\nCleanEfiOptions class.",
      "additionalProperties": false,
      "properties": {
        "Type": {
          "description": "The type of the partition. The default is 'Normal'.",
          "enum": [
            "Normal",
            "System",
            "Msr",
            "Utility"
          ]
        },
        "Label": {
          "type": [
            "null",
            "string"
          ],
          "description": "The label of the partition."
        },
        "Size": {
          "description": "The size of the partition, which can be a value like '100MB', or null to fill the remaining space. Only the last partition may have a null size.",
          "type": ["string", "null"]
        },
        "FileSystem": {
          "type": [
            "null",
            "string"
          ],
          "description": "The file system to format the partition with, or null to use the default file system for the partition type."
        }
      }
    },
    "DomainOptions": {
      "type": "object",
      "description": "Provides options for joining a domain.",
      "required": [
        "Domain",
        "Credential"
      ],
      "additionalProperties": false,
      "properties": {
        "Domain": {
          "type": "string",
          "description": "The name of the domain to join."
        },
        "Credential": {
          "description": "The credentials of a domain account that has permission to join the domain.",
          "$ref": "#/definitions/DomainCredential"
        },
        "OUPath": {
          "type": [
            "null",
            "string"
          ],
          "description": "The path of the Organizational Unit that the computer account should be added to, or null to use the domain default."
        },
        "DomainAccounts": {
          "type": "array",
          "description": "A list of domain accounts that should be added to a local group.",
          "items": {
            "$ref": "#/definitions/DomainUserGroup"
          }
        }
      }
    },
    "DomainCredential": {
      "type": "object",
      "description": "Represents a credential for a domain or local user.",
      "additionalProperties": false,
      "required": [
        "UserAccount",
        "Password"
      ],
      "properties": {
        "UserAccount": {
          "type": "string",
          "description": "The domain or local user account, in the format 'domain\\user' or 'user'."
        },
        "Password": {
          "type": "string",
          "description": "The password for the account."
        }
      }
    },
    "DomainUserGroup": {
      "type": "object",
      "description": "Represents a domain user and the local group to which they should be added.",
      "additionalProperties": false,
      "required": [
        "DomainUser",
        "Group"
      ],
      "properties": {
        "DomainUser": {
          "type": "string",
          "description": "Gets the domain user that is being added to a group, in the format 'domain\\user' or 'user'. If no domain is specified, it's assumed to be the same as the domain being joined."
        },
        "Group": {
          "type": ["string", "null"],
          "description": "The group to which the user will be added. The default is 'Administrators'."
        }
      }
    },
    "LocalCredential": {
      "type": "object",
      "description": "Provides credentials for a local user account.",
      "additionalProperties": false,
      "required": [
        "UserName",
        "Password"
      ],
      "properties": {
        "UserName": {
          "type": "string",
          "description": "The user name of the account."
        },
        "Password": {
          "type": "string",
          "description": "The password of the account."
        }
      }
    },
    "AutoLogonOptions": {
      "type": "object",
      "description": "Provides options for logging on automatically.",
      "additionalProperties": false,
      "required": [
        "Credential"
      ],
      "properties": {
        "Credential": {
          "description": "The credentials used to log on automatically.",
          "$ref": "#/definitions/DomainCredential"
        },
        "Count": {
          "type": "integer",
          "description": "The number of times automatic log-on will be used. The default value is 1.",
          "format": "int32",
          "minimum": 1
        }
      }
    }
  }
}